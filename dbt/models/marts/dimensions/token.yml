version: 2

models:
  - name: token
    description: "Dimension table for token reference data. Provides token metadata for joining with fact tables."
    config:
      contract:
        enforced: true
      meta:
        primary_key: ["chain_id", "address"]
    tests:
      - dbt_utils.unique_combination_of_columns:
          arguments:
            combination_of_columns:
              - chain_id
              - representation_address
    columns:
      - name: chain_id
        description: "Chain ID where the token exists (foreign key to chain.chain_id)"
        data_type: Int64
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('chain')
                field: chain_id
          - unique:
              name: unique_native_tokens_per_chain
              config:
                where: "is_native"
      - name: representation_address
        description: "Representation token address (bytes), 0x0000000000000000000000000000000000000000 for native tokens"
        data_type: String
        tests:
          - not_null
      - name: erc20_address
        description: "ERC20 token address (bytes), null for native tokens"
        data_type: Nullable(String)
      - name: is_native
        description: "Whether token is native"
        data_type: Bool
        tests:
          - not_null
      - name: symbol
        description: "Token symbol"
        data_type: String
        tests:
          - not_null
      - name: name
        description: "Token name"
        data_type: String
        tests:
          - not_null
      - name: decimals
        description: "Number of decimals for the token"
        data_type: Int64
        tests:
          - not_null

      # - name: oracle
      #   description: "Oracle used for price data"
      # - name: oracle_id
      #   description: "Oracle identifier"
      # - name: type
      #   description: "Token type"
      # - name: bridge
      #   description: "Bridge information"
      # - name: staked
      #   description: "Whether token is staked"
